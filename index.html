
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Google Drive Web App</title>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://apis.google.com/js/api.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; }
    button { padding: 10px 16px; margin: 5px 0; }
    ul { margin-top: 20px; }
  </style>
</head>
<body>

<h2>Google Drive Web App</h2>

<button onclick="login()">Login Google</button>
<button onclick="listFiles()">List File Drive</button>

<ul id="fileList"></ul>

<script>
const CLIENT_ID = 'ISI_CLIENT_ID_KAMU';
const API_KEY = 'ISI_API_KEY_KAMU';
const SCOPES = 'https://www.googleapis.com/auth/drive';

let tokenClient;
let gapiInited = false;
let gisInited = false;

function gapiLoaded() {
  gapi.load('client', initializeGapiClient);
}

async function initializeGapiClient() {
  await gapi.client.init({
    apiKey: API_KEY,
    discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],
  });
  gapiInited = true;
}

function gisLoaded() {
  tokenClient = google.accounts.oauth2.initTokenClient({
    client_id: CLIENT_ID,
    scope: SCOPES,
    callback: ''
  });
  gisInited = true;
}

function login() {
  tokenClient.callback = (resp) => {
    if (resp.error !== undefined) {
      throw resp;
    }
    alert('Login berhasil');
  };
  tokenClient.requestAccessToken({ prompt: 'consent' });
}

async function listFiles() {
  const response = await gapi.client.drive.files.list({
    pageSize: 10,
    fields: 'files(id, name, mimeType)'
  });

  const list = document.getElementById('fileList');
  list.innerHTML = '';

  response.result.files.forEach(file => {
    const li = document.createElement('li');
    li.textContent = `${file.name} (${file.mimeType})`;
    list.appendChild(li);
  });
}

window.onload = () => {
  gapiLoaded();
  gisLoaded();
};
</script>

</body>
</html>
