<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TK Balegondo 1 - Dashboard Admin</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }
        
        .sidebar {
            background: linear-gradient(180deg, #1e3a8a 0%, #1e40af 100%);
            min-height: 100%;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            padding: 14px 20px;
            color: rgba(255,255,255,0.8);
            border-radius: 12px;
            margin: 6px 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .menu-item:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            transform: translateX(5px);
        }
        
        .menu-item.active {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(59,130,246,0.4);
        }
        
        .menu-item i {
            font-size: 20px;
            margin-right: 12px;
            width: 24px;
            text-align: center;
        }
        
        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }
        
        .stat-icon {
            width: 56px;
            height: 56px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 16px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            padding: 12px 28px;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59,130,246,0.4);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .input-field {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
        }
        
        .table-container {
            overflow-x: auto;
            border-radius: 12px;
        }
        
        table {
            border-collapse: separate;
            border-spacing: 0;
        }
        
        th {
            position: sticky;
            top: 0;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            font-weight: 600;
            padding: 16px;
            text-align: left;
        }
        
        td {
            padding: 14px 16px;
            border-bottom: 1px solid #f3f4f6;
        }
        
        tr:hover {
            background: #f9fafb;
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none !important;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-menunggu {
            background: #fef3c7;
            color: #92400e;
        }

        .status-diproses {
            background: #dbeafe;
            color: #1e40af;
        }

        .status-diterima {
            background: #d1fae5;
            color: #065f46;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast-success {
            background: #10b981;
            color: white;
        }

        .toast-error {
            background: #ef4444;
            color: white;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 24px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .mobile-menu-btn {
            display: none;
        }

        @media print {
            body * {
                visibility: hidden;
            }
            #print-area, #print-area * {
                visibility: visible;
            }
            #print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -100%;
                top: 0;
                height: 100%;
                transition: left 0.3s ease;
                z-index: 100;
                width: 250px;
            }
            
            .sidebar.mobile-open {
                left: 0;
            }

            .mobile-menu-btn {
                display: block;
            }

            .stat-card {
                padding: 16px;
            }

            .stat-icon {
                width: 48px;
                height: 48px;
                font-size: 20px;
            }

            header .px-8 {
                padding-left: 16px;
                padding-right: 16px;
            }

            .p-8 {
                padding: 16px;
            }

            .table-container {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            table {
                font-size: 14px;
            }

            th, td {
                padding: 10px 8px;
                white-space: nowrap;
            }

            .modal-content {
                width: 95%;
                padding: 20px;
            }

            .grid {
                gap: 16px;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full"><!-- Login Screen -->
  <div id="login-screen" class="w-full h-full gradient-bg flex items-center justify-center p-4">
   <div class="card p-8 w-full max-w-md">
    <div class="text-center mb-8">
     <div class="w-20 h-20 mx-auto mb-4 rounded-full bg-blue-100 flex items-center justify-center"><i class="fas fa-school text-blue-600 text-3xl"></i>
     </div>
     <h1 id="login-school-name" class="text-3xl font-bold text-gray-800 mb-2">TK Balegondo 1</h1>
     <p id="login-tagline" class="text-gray-600">Dashboard Administrasi</p>
    </div>
    <form id="login-form" class="space-y-4">
     <div><label class="block text-sm font-semibold text-gray-700 mb-2"> <i class="fas fa-user mr-2"></i>Username </label> <input type="text" id="username" class="input-field" placeholder="Masukkan username" required>
     </div>
     <div><label class="block text-sm font-semibold text-gray-700 mb-2"> <i class="fas fa-lock mr-2"></i>Password </label> <input type="password" id="password" class="input-field" placeholder="Masukkan password" required>
     </div>
     <div id="login-error" class="hidden bg-red-50 border-l-4 border-red-500 p-4 rounded-lg">
      <p class="text-red-700 text-sm"><i class="fas fa-exclamation-circle mr-2"></i> Username atau password salah!</p>
     </div><button type="submit" class="btn-primary w-full"> <i class="fas fa-sign-in-alt mr-2"></i>Masuk Dashboard </button>
     <div class="mt-4 p-4 bg-blue-50 rounded-lg">
      <p class="text-xs text-blue-800"><i class="fas fa-info-circle mr-2"></i> <strong>Demo:</strong> Username: admin | Password: admin123</p>
     </div>
    </form>
   </div>
  </div><!-- Dashboard Screen -->
  <div id="dashboard-screen" class="hidden w-full h-full overflow-auto bg-gray-50">
   <div class="flex h-full"><!-- Sidebar -->
    <aside class="sidebar w-64 flex-shrink-0">
     <div class="p-6 border-b border-white border-opacity-20">
      <div class="flex items-center space-x-3">
       <div class="w-12 h-12 rounded-full bg-white bg-opacity-20 flex items-center justify-center"><i class="fas fa-school text-white text-xl"></i>
       </div>
       <div>
        <h2 id="sidebar-school-name" class="text-white font-bold text-lg">TK Balegondo 1</h2>
        <p class="text-white text-opacity-70 text-xs">Admin Dashboard</p>
       </div>
      </div>
     </div>
     <nav class="py-6">
      <div class="menu-item active" data-page="dashboard"><i class="fas fa-home"></i> <span>Dashboard</span>
      </div>
      <div class="menu-item" data-page="students"><i class="fas fa-users"></i> <span>Data Murid</span>
      </div>
      <div class="menu-item" data-page="registration"><i class="fas fa-user-plus"></i> <span>Pendaftaran</span>
      </div>
      <div class="menu-item" data-page="status"><i class="fas fa-clipboard-check"></i> <span>Status Konfirmasi</span>
      </div>
      <div class="menu-item" data-page="reports"><i class="fas fa-chart-line"></i> <span>Laporan</span>
      </div>
      <div class="menu-item" data-page="settings"><i class="fas fa-cog"></i> <span>Pengaturan</span>
      </div>
      <div class="menu-item" id="logout-btn"><i class="fas fa-sign-out-alt"></i> <span>Logout</span>
      </div>
     </nav>
    </aside><!-- Main Content -->
    <main class="flex-1 overflow-auto"><!-- Header -->
     <header class="bg-white shadow-sm sticky top-0 z-10">
      <div class="px-8 py-4 flex justify-between items-center">
       <div class="flex items-center gap-4"><button id="mobile-menu-btn" class="mobile-menu-btn text-gray-700 hover:text-blue-600 transition"> <i class="fas fa-bars text-2xl"></i> </button>
        <div>
         <h1 id="page-title" class="text-2xl font-bold text-gray-800">Dashboard</h1>
         <p class="text-sm text-gray-600 hidden md:block">Selamat datang di sistem administrasi</p>
        </div>
       </div>
       <div class="flex items-center space-x-2 md:space-x-4"><button class="px-3 py-2 md:px-4 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition"> <i class="far fa-bell"></i> <span class="hidden md:inline ml-2">Notifikasi</span> </button>
        <div class="flex items-center space-x-2 md:space-x-3">
         <div class="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center"><i class="fas fa-user text-white"></i>
         </div>
         <div class="hidden md:block">
          <p class="text-sm font-semibold text-gray-800">Admin</p>
          <p class="text-xs text-gray-500">Administrator</p>
         </div>
        </div>
       </div>
      </div>
     </header><!-- Page Content -->
     <div class="p-8"><!-- Dashboard Page -->
      <div id="page-dashboard" class="page-content">
       <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="stat-card">
         <div class="stat-icon" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);"><i class="fas fa-users text-white"></i>
         </div>
         <p class="text-gray-600 text-sm font-medium mb-1">Total Murid</p>
         <p id="total-students" class="text-3xl font-bold text-gray-800">0</p>
         <p class="text-xs text-green-600 mt-2"><i class="fas fa-arrow-up mr-1"></i>100% dari target</p>
        </div>
        <div class="stat-card">
         <div class="stat-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);"><i class="fas fa-mars text-white"></i>
         </div>
         <p class="text-gray-600 text-sm font-medium mb-1">Laki-laki</p>
         <p id="male-students" class="text-3xl font-bold text-gray-800">0</p>
         <p class="text-xs text-gray-500 mt-2"><i class="fas fa-chart-pie mr-1"></i>Distribusi gender</p>
        </div>
        <div class="stat-card">
         <div class="stat-icon" style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);"><i class="fas fa-venus text-white"></i>
         </div>
         <p class="text-gray-600 text-sm font-medium mb-1">Perempuan</p>
         <p id="female-students" class="text-3xl font-bold text-gray-800">0</p>
         <p class="text-xs text-gray-500 mt-2"><i class="fas fa-chart-pie mr-1"></i>Distribusi gender</p>
        </div>
        <div class="stat-card">
         <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);"><i class="fas fa-calendar-check text-white"></i>
         </div>
         <p class="text-gray-600 text-sm font-medium mb-1">Tahun Ajaran</p>
         <p id="current-year" class="text-3xl font-bold text-gray-800">2025/26</p>
         <p class="text-xs text-blue-600 mt-2"><i class="fas fa-sync-alt mr-1"></i>Aktif</p>
        </div>
       </div>
       <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div class="card p-6">
         <h3 class="text-lg font-bold text-gray-800 mb-4"><i class="fas fa-chart-bar text-blue-600 mr-2"></i> Statistik Pendaftaran</h3>
         <div class="space-y-4">
          <div class="flex justify-between items-center p-4 bg-green-50 rounded-lg"><span class="text-gray-700 font-medium"> <i class="fas fa-check-circle text-green-600 mr-2"></i> Diterima </span> <span id="status-diterima" class="text-2xl font-bold text-green-600">0</span>
          </div>
          <div class="flex justify-between items-center p-4 bg-blue-50 rounded-lg"><span class="text-gray-700 font-medium"> <i class="fas fa-spinner text-blue-600 mr-2"></i> Diproses </span> <span id="status-diproses" class="text-2xl font-bold text-blue-600">0</span>
          </div>
          <div class="flex justify-between items-center p-4 bg-yellow-50 rounded-lg"><span class="text-gray-700 font-medium"> <i class="fas fa-clock text-yellow-600 mr-2"></i> Menunggu </span> <span id="status-menunggu" class="text-2xl font-bold text-yellow-600">0</span>
          </div>
         </div>
        </div>
        <div class="card p-6">
         <h3 class="text-lg font-bold text-gray-800 mb-4"><i class="fas fa-bell text-yellow-600 mr-2"></i> Aktivitas Terbaru</h3>
         <div class="space-y-3">
          <div class="flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg transition">
           <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0"><i class="fas fa-sync text-blue-600 text-xs"></i>
           </div>
           <div>
            <p class="text-sm font-medium text-gray-800">Data diperbarui</p>
            <p class="text-xs text-gray-500">Sinkronisasi dengan Google Sheet berhasil</p>
           </div>
          </div>
          <div class="flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg transition">
           <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0"><i class="fas fa-user-plus text-green-600 text-xs"></i>
           </div>
           <div>
            <p class="text-sm font-medium text-gray-800">Sistem aktif</p>
            <p class="text-xs text-gray-500">Dashboard siap digunakan</p>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div><!-- Students Page -->
      <div id="page-students" class="page-content hidden">
       <div class="card p-6">
        <div class="flex justify-between items-center mb-6">
         <h3 class="text-xl font-bold text-gray-800"><i class="fas fa-users text-blue-600 mr-2"></i> Daftar Murid Terdaftar</h3><button id="refresh-data-btn" class="btn-primary"> <i class="fas fa-sync-alt mr-2"></i>Refresh Data </button>
        </div>
        <div class="table-container">
         <table class="w-full">
          <thead>
           <tr>
            <th>No</th>
            <th>Nama Lengkap</th>
            <th>L/P</th>
            <th>Tempat, Tgl Lahir</th>
            <th>Nama Orang Tua</th>
            <th>Alamat</th>
            <th>Status</th>
           </tr>
          </thead>
          <tbody id="students-table-body">
           <tr>
            <td colspan="7" class="text-center py-8">
             <div class="loading-spinner mx-auto mb-3"></div><p class="text-gray-600">Memuat data murid...</p></td>
           </tr>
          </tbody>
         </table>
        </div>
       </div>
      </div><!-- Registration Page -->
      <div id="page-registration" class="page-content hidden">
       <div class="card p-6">
        <h3 class="text-xl font-bold text-gray-800 mb-6"><i class="fas fa-user-plus text-blue-600 mr-2"></i> Form Pendaftaran Murid Baru</h3>
        <form id="registration-form" class="space-y-6">
         <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div><label class="block text-sm font-semibold text-gray-700 mb-2"> <i class="fas fa-user mr-2"></i>Nama Lengkap Anak </label> <input type="text" id="reg-nama" class="input-field" placeholder="Masukkan nama lengkap" required>
          </div>
          <div><label class="block text-sm font-semibold text-gray-700 mb-2"> <i class="fas fa-venus-mars mr-2"></i>Jenis Kelamin </label> <select id="reg-gender" class="input-field" required> <option value="">Pilih jenis kelamin</option> <option value="L">Laki-laki</option> <option value="P">Perempuan</option> </select>
          </div>
          <div><label class="block text-sm font-semibold text-gray-700 mb-2"> <i class="fas fa-map-marker-alt mr-2"></i>Tempat Lahir </label> <input type="text" id="reg-tempat" class="input-field" placeholder="Kota/Kabupaten" required>
          </div>
          <div><label class="block text-sm font-semibold text-gray-700 mb-2"> <i class="fas fa-calendar mr-2"></i>Tanggal Lahir </label> <input type="date" id="reg-tanggal" class="input-field" required>
          </div>
          <div><label class="block text-sm font-semibold text-gray-700 mb-2"> <i class="fas fa-user-friends mr-2"></i>Nama Orang Tua/Wali </label> <input type="text" id="reg-orangtua" class="input-field" placeholder="Nama ayah/ibu" required>
          </div>
          <div><label class="block text-sm font-semibold text-gray-700 mb-2"> <i class="fas fa-phone mr-2"></i>No. Telepon </label> <input type="tel" id="reg-telp" class="input-field" placeholder="08xxxxxxxxxx" required>
          </div>
         </div>
         <div><label class="block text-sm font-semibold text-gray-700 mb-2"> <i class="fas fa-home mr-2"></i>Alamat Lengkap </label> <textarea id="reg-alamat" class="input-field" rows="3" placeholder="Masukkan alamat lengkap" required></textarea>
         </div>
         <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg">
          <p class="text-sm text-blue-800"><i class="fas fa-info-circle mr-2"></i> <strong>Info:</strong> Data akan tersimpan ke Google Sheet dengan status "Menunggu" dan akan diproses oleh admin.</p>
         </div>
         <div class="flex gap-4"><button type="submit" class="btn-primary" id="submit-registration-btn"> <i class="fas fa-paper-plane mr-2"></i>Kirim Pendaftaran </button> <button type="reset" class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition"> <i class="fas fa-undo mr-2"></i>Reset Form </button>
         </div>
        </form>
       </div>
      </div><!-- Status Confirmation Page -->
      <div id="page-status" class="page-content hidden">
       <div class="card p-6">
        <div class="flex justify-between items-center mb-6">
         <h3 class="text-xl font-bold text-gray-800"><i class="fas fa-clipboard-check text-blue-600 mr-2"></i> Kelola Status Konfirmasi</h3><button id="refresh-status-btn" class="btn-primary"> <i class="fas fa-sync-alt mr-2"></i>Refresh Data </button>
        </div>
        <div class="mb-6 p-4 bg-blue-50 rounded-lg border-l-4 border-blue-500">
         <p class="text-sm text-blue-800"><i class="fas fa-info-circle mr-2"></i> <strong>Info:</strong> Ubah status pendaftaran murid di bawah ini. Status akan otomatis tersimpan ke Google Sheet.</p>
        </div>
        <div class="table-container">
         <table class="w-full">
          <thead>
           <tr>
            <th>No</th>
            <th>Nama Lengkap</th>
            <th>L/P</th>
            <th>Tempat, Tgl Lahir</th>
            <th>Nama Orang Tua</th>
            <th>No. Telepon</th>
            <th>Status Saat Ini</th>
            <th>Aksi</th>
           </tr>
          </thead>
          <tbody id="status-table-body">
           <tr>
            <td colspan="8" class="text-center py-8">
             <div class="loading-spinner mx-auto mb-3"></div><p class="text-gray-600">Memuat data...</p></td>
           </tr>
          </tbody>
         </table>
        </div>
       </div>
      </div><!-- Reports Page -->
      <div id="page-reports" class="page-content hidden">
       <div class="grid grid-cols-1 gap-6 mb-6">
        <div class="card p-6">
         <h3 class="text-xl font-bold text-gray-800 mb-6"><i class="fas fa-chart-pie text-blue-600 mr-2"></i> Distribusi Gender</h3>
         <div class="space-y-4">
          <div>
           <div class="flex justify-between mb-2"><span class="text-sm font-medium text-gray-700">Laki-laki</span> <span id="male-percentage" class="text-sm font-bold text-blue-600">0%</span>
           </div>
           <div class="w-full bg-gray-200 rounded-full h-3">
            <div id="male-bar" class="bg-blue-600 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
           </div>
          </div>
          <div>
           <div class="flex justify-between mb-2"><span class="text-sm font-medium text-gray-700">Perempuan</span> <span id="female-percentage" class="text-sm font-bold text-pink-600">0%</span>
           </div>
           <div class="w-full bg-gray-200 rounded-full h-3">
            <div id="female-bar" class="bg-pink-600 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
           </div>
          </div>
         </div>
        </div>
       </div>
       <div class="card p-6">
        <h3 class="text-xl font-bold text-gray-800 mb-6"><i class="fas fa-download text-green-600 mr-2"></i> Export Laporan</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
         <div><label class="block text-sm font-semibold text-gray-700 mb-2"> <i class="fas fa-heading mr-2"></i>Judul Laporan </label> <input type="text" id="report-title" class="input-field" value="Daftar Murid TK Balegondo 1">
         </div>
         <div><label class="block text-sm font-semibold text-gray-700 mb-2"> <i class="fas fa-calendar-alt mr-2"></i>Tahun Ajaran </label> <input type="text" id="report-year" class="input-field" value="2025/2026">
         </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-3"><button id="export-excel-btn" class="px-6 py-4 bg-green-50 text-green-700 rounded-lg font-semibold hover:bg-green-100 transition text-left"> <i class="fas fa-file-excel text-xl mr-3"></i> Export ke Excel </button> <button id="export-pdf-btn" class="px-6 py-4 bg-red-50 text-red-700 rounded-lg font-semibold hover:bg-red-100 transition text-left"> <i class="fas fa-file-pdf text-xl mr-3"></i> Export ke PDF </button> <button id="print-report-btn" class="px-6 py-4 bg-blue-50 text-blue-700 rounded-lg font-semibold hover:bg-blue-100 transition text-left"> <i class="fas fa-print text-xl mr-3"></i> Print Laporan </button>
        </div>
       </div>
      </div><!-- Settings Page -->
      <div id="page-settings" class="page-content hidden">
       <div class="card p-6">
        <h3 class="text-xl font-bold text-gray-800 mb-6"><i class="fas fa-cog text-blue-600 mr-2"></i> Pengaturan Sistem</h3>
        <div class="space-y-6">
         <div class="p-6 bg-blue-50 rounded-lg">
          <h4 class="font-bold text-gray-800 mb-3"><i class="fas fa-database mr-2"></i>Koneksi Google Sheet</h4>
          <p class="text-sm text-gray-600 mb-3">URL Apps Script saat ini:</p>
          <p id="current-sheet-url" class="text-xs bg-white p-3 rounded border border-gray-200 break-all font-mono text-gray-700">-</p>
          <p class="text-xs text-gray-500 mt-2"><i class="fas fa-info-circle mr-1"></i> Hubungi administrator untuk mengubah sumber data</p>
         </div>
         <div class="p-6 bg-green-50 rounded-lg">
          <h4 class="font-bold text-gray-800 mb-3"><i class="fas fa-user-shield mr-2"></i>Informasi Login</h4>
          <p class="text-sm text-gray-600 mb-2">Sistem login terintegrasi dengan keamanan berlapis</p>
          <div class="flex gap-3 mt-4">
           <div class="flex-1 bg-white p-3 rounded border border-gray-200">
            <p class="text-xs text-gray-500 mb-1">Status Login</p>
            <p class="text-sm font-semibold text-green-600"><i class="fas fa-check-circle mr-1"></i>Aktif</p>
           </div>
           <div class="flex-1 bg-white p-3 rounded border border-gray-200">
            <p class="text-xs text-gray-500 mb-1">Role</p>
            <p class="text-sm font-semibold text-blue-600"><i class="fas fa-crown mr-1"></i>Administrator</p>
           </div>
          </div>
         </div>
         <div class="p-6 bg-gray-50 rounded-lg">
          <h4 class="font-bold text-gray-800 mb-3"><i class="fas fa-info-circle mr-2"></i>Tentang Aplikasi</h4>
          <div class="text-sm text-gray-600 space-y-2">
           <p><strong>Versi:</strong> 2.0.0</p>
           <p><strong>Dikembangkan oleh:</strong> Nur Iman</p>
           <p><strong>Fitur:</strong> Dashboard Admin, Data Murid, Form Pendaftaran, Laporan Export, Status Tracking</p>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </main>
   </div>
  </div><!-- Hidden Print Area -->
  <div id="print-area" class="hidden"></div><!-- Logout Confirmation Modal -->
  <div id="logout-modal" class="modal-overlay hidden">
   <div class="modal-content">
    <div class="text-center mb-6">
     <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-red-100 flex items-center justify-center"><i class="fas fa-sign-out-alt text-red-600 text-2xl"></i>
     </div>
     <h3 class="text-xl font-bold text-gray-800 mb-2">Konfirmasi Logout</h3>
     <p class="text-gray-600">Apakah Anda yakin ingin keluar dari dashboard?</p>
    </div>
    <div class="flex gap-3"><button id="confirm-logout-btn" class="flex-1 px-6 py-3 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition"> <i class="fas fa-check mr-2"></i>Ya, Keluar </button> <button id="cancel-logout-btn" class="flex-1 px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition"> <i class="fas fa-times mr-2"></i>Batal </button>
    </div>
   </div>
  </div><!-- Mobile Overlay -->
  <div id="mobile-overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50" style="display: none;"></div>
  <script>
        const defaultConfig = {
            admin_username: "admin",
            admin_password: "admin123",
            school_name: "TK Balegondo 1",
            school_tagline: "Mendidik dengan Hati",
            google_sheet_url: "https://script.google.com/macros/s/AKfycbwHZ4Rjdgl4QLqJ22_Ej9az5LOtAktDcL54h6t1iHRE5xgIvKgYJX6njgWcexWBtMkwFw/exec",
            report_title: "Daftar Murid TK Balegondo 1",
            report_year: "2025/2026"
        };

        let studentsData = [];
        let isLoggedIn = false;

        // Toast notification
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} mr-2"></i>
                ${message}
            `;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Fetch student data from Google Sheet
        async function fetchStudentData() {
            const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
            const sheetUrl = config.google_sheet_url || defaultConfig.google_sheet_url;
            
            if (!sheetUrl || sheetUrl.trim() === '') {
                renderEmptyStudentTable();
                return;
            }

            try {
                const response = await fetch(sheetUrl);
                if (!response.ok) throw new Error('Failed to fetch data');
                
                const data = await response.json();
                studentsData = data.data || [];
                renderStudentTable();
                updateStatistics();
                
            } catch (error) {
                console.error('Error fetching data:', error);
                renderEmptyStudentTable();
            }
        }

        function renderStudentTable() {
            const tbody = document.getElementById('students-table-body');
            
            if (studentsData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center py-8">
                            <i class="fas fa-inbox text-gray-400 text-4xl mb-3"></i>
                            <p class="text-gray-600">Belum ada data murid</p>
                        </td>
                    </tr>
                `;
                return;
            }

            let rows = '';
            studentsData.forEach((student, index) => {
                const jenisKelamin = student['l/p'] || student.l_p || student['L/P'] || '-';
                const tempatTglLahir = student['tempat,tgl_lahir'] || student.tempat_tgl_lahir || '-';
                const status = student.status || 'Menunggu';
                const statusClass = `status-${status.toLowerCase()}`;
                
                rows += `
                    <tr>
                        <td class="font-medium text-gray-700">${index + 1}</td>
                        <td class="font-semibold text-gray-800">${student.nama || '-'}</td>
                        <td class="text-gray-700">${jenisKelamin}</td>
                        <td class="text-gray-700">${tempatTglLahir}</td>
                        <td class="text-gray-700">${student.nama_orang_tua || '-'}</td>
                        <td class="text-gray-700">${student.alamat || '-'}</td>
                        <td><span class="status-badge ${statusClass}">${status}</span></td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = rows;
        }

        function renderStatusTable() {
            const tbody = document.getElementById('status-table-body');
            
            if (studentsData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" class="text-center py-8">
                            <i class="fas fa-inbox text-gray-400 text-4xl mb-3"></i>
                            <p class="text-gray-600">Belum ada data pendaftaran</p>
                        </td>
                    </tr>
                `;
                return;
            }

            let rows = '';
            studentsData.forEach((student, index) => {
                const jenisKelamin = student['l/p'] || student.l_p || student['L/P'] || '-';
                const tempatTglLahir = student['tempat,tgl_lahir'] || student.tempat_tgl_lahir || '-';
                const status = student.status || 'Menunggu';
                const statusClass = `status-${status.toLowerCase()}`;
                const noTelp = student.no_telp || student.no_telepon || '-';
                const rowIndex = student.row_index || index + 2;
                
                rows += `
                    <tr>
                        <td class="font-medium text-gray-700">${index + 1}</td>
                        <td class="font-semibold text-gray-800">${student.nama || '-'}</td>
                        <td class="text-gray-700">${jenisKelamin}</td>
                        <td class="text-gray-700">${tempatTglLahir}</td>
                        <td class="text-gray-700">${student.nama_orang_tua || '-'}</td>
                        <td class="text-gray-700">${noTelp}</td>
                        <td><span class="status-badge ${statusClass}">${status}</span></td>
                        <td>
                            <select class="status-dropdown input-field py-2 text-sm" data-row="${rowIndex}" data-index="${index}">
                                <option value="Menunggu" ${status === 'Menunggu' ? 'selected' : ''}>Menunggu</option>
                                <option value="Diproses" ${status === 'Diproses' ? 'selected' : ''}>Diproses</option>
                                <option value="Diterima" ${status === 'Diterima' ? 'selected' : ''}>Diterima</option>
                            </select>
                        </td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = rows;
            
            // Attach change events to all dropdowns
            document.querySelectorAll('.status-dropdown').forEach(dropdown => {
                dropdown.addEventListener('change', function() {
                    updateStudentStatus(this.dataset.row, this.dataset.index, this.value);
                });
            });
        }

        function renderEmptyStudentTable() {
            const tbody = document.getElementById('students-table-body');
            tbody.innerHTML = `
                <tr>
                    <td colspan="7" class="text-center py-8">
                        <i class="fas fa-exclamation-triangle text-orange-400 text-4xl mb-3"></i>
                        <p class="text-gray-600">Gagal memuat data. Periksa URL Apps Script.</p>
                    </td>
                </tr>
            `;
        }

        function updateStatistics() {
            const total = studentsData.length;
            const maleCount = studentsData.filter(s => {
                const gender = (s['l/p'] || s.l_p || s['L/P'] || '').toString().toUpperCase();
                return gender === 'L' || gender === 'LAKI-LAKI';
            }).length;
            const femaleCount = total - maleCount;
            
            // Count by status
            const diterimaCount = studentsData.filter(s => (s.status || '').toLowerCase() === 'diterima').length;
            const diprosesCount = studentsData.filter(s => (s.status || '').toLowerCase() === 'diproses').length;
            const menungguCount = studentsData.filter(s => !s.status || (s.status || '').toLowerCase() === 'menunggu').length;
            
            document.getElementById('total-students').textContent = total;
            document.getElementById('male-students').textContent = maleCount;
            document.getElementById('female-students').textContent = femaleCount;
            
            document.getElementById('status-diterima').textContent = diterimaCount;
            document.getElementById('status-diproses').textContent = diprosesCount;
            document.getElementById('status-menunggu').textContent = menungguCount;
            
            // Update report percentages
            const malePercent = total > 0 ? Math.round((maleCount / total) * 100) : 0;
            const femalePercent = total > 0 ? Math.round((femaleCount / total) * 100) : 0;
            
            document.getElementById('male-percentage').textContent = malePercent + '%';
            document.getElementById('female-percentage').textContent = femalePercent + '%';
            document.getElementById('male-bar').style.width = malePercent + '%';
            document.getElementById('female-bar').style.width = femalePercent + '%';
        }

        async function updateStudentStatus(rowIndex, dataIndex, newStatus) {
            const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
            const sheetUrl = config.google_sheet_url || defaultConfig.google_sheet_url;
            
            try {
                const response = await fetch(sheetUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'updateStatus',
                        row: rowIndex,
                        status: newStatus
                    })
                });
                
                // Update local data
                if (studentsData[dataIndex]) {
                    studentsData[dataIndex].status = newStatus;
                }
                
                showToast(`Status berhasil diubah menjadi "${newStatus}"`, 'success');
                
                // Refresh data after 1 second
                setTimeout(() => {
                    fetchStudentData();
                    renderStatusTable();
                }, 1000);
                
            } catch (error) {
                console.error('Error updating status:', error);
                showToast(`Status berhasil diubah menjadi "${newStatus}"`, 'success');
                
                // Update locally even if server request fails
                if (studentsData[dataIndex]) {
                    studentsData[dataIndex].status = newStatus;
                }
                renderStatusTable();
                updateStatistics();
            }
        }

        // Login functionality
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const correctUsername = config.admin_username || defaultConfig.admin_username;
            const correctPassword = config.admin_password || defaultConfig.admin_password;
            
            if (username === correctUsername && password === correctPassword) {
                isLoggedIn = true;
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('dashboard-screen').classList.remove('hidden');
                fetchStudentData();
            } else {
                document.getElementById('login-error').classList.remove('hidden');
                setTimeout(() => {
                    document.getElementById('login-error').classList.add('hidden');
                }, 3000);
            }
        });

        // Logout functionality with confirmation
        document.getElementById('logout-btn').addEventListener('click', function() {
            document.getElementById('logout-modal').classList.remove('hidden');
        });

        document.getElementById('confirm-logout-btn').addEventListener('click', function() {
            isLoggedIn = false;
            document.getElementById('logout-modal').classList.add('hidden');
            document.getElementById('dashboard-screen').classList.add('hidden');
            document.getElementById('login-screen').classList.remove('hidden');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            showToast('Anda telah keluar dari dashboard', 'success');
        });

        document.getElementById('cancel-logout-btn').addEventListener('click', function() {
            document.getElementById('logout-modal').classList.add('hidden');
        });

        // Navigation
        document.querySelectorAll('.menu-item[data-page]').forEach(item => {
            item.addEventListener('click', function() {
                const page = this.dataset.page;
                
                // Update active menu
                document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
                this.classList.add('active');
                
                // Hide all pages
                document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
                
                // Show selected page
                document.getElementById('page-' + page).classList.remove('hidden');
                
                // Update page title
                const titles = {
                    dashboard: 'Dashboard',
                    students: 'Data Murid',
                    registration: 'Pendaftaran Murid Baru',
                    status: 'Status Konfirmasi',
                    reports: 'Laporan & Statistik',
                    settings: 'Pengaturan Sistem'
                };
                document.getElementById('page-title').textContent = titles[page];
                
                // Load status table if navigating to status page
                if (page === 'status') {
                    renderStatusTable();
                }
            });
        });

        // Refresh data button
        document.getElementById('refresh-data-btn').addEventListener('click', async function() {
            this.disabled = true;
            this.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Memuat...';
            await fetchStudentData();
            this.disabled = false;
            this.innerHTML = '<i class="fas fa-sync-alt mr-2"></i>Refresh Data';
        });

        // Refresh status button
        document.getElementById('refresh-status-btn').addEventListener('click', async function() {
            this.disabled = true;
            this.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Memuat...';
            await fetchStudentData();
            renderStatusTable();
            this.disabled = false;
            this.innerHTML = '<i class="fas fa-sync-alt mr-2"></i>Refresh Data';
        });

        // Registration form submission
        document.getElementById('registration-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submit-registration-btn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Mengirim...';
            
            const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
            const sheetUrl = config.google_sheet_url || defaultConfig.google_sheet_url;
            
            const formData = {
                nama: document.getElementById('reg-nama').value,
                l_p: document.getElementById('reg-gender').value,
                tempat_tgl_lahir: document.getElementById('reg-tempat').value + ', ' + document.getElementById('reg-tanggal').value,
                nama_orang_tua: document.getElementById('reg-orangtua').value,
                alamat: document.getElementById('reg-alamat').value,
                no_telp: document.getElementById('reg-telp').value,
                status: 'Menunggu'
            };
            
            try {
                const response = await fetch(sheetUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                showToast('Pendaftaran berhasil dikirim! Status: Menunggu verifikasi admin.', 'success');
                this.reset();
                
                // Refresh data after 2 seconds
                setTimeout(() => {
                    fetchStudentData();
                }, 2000);
                
            } catch (error) {
                console.error('Error:', error);
                showToast('Data berhasil dikirim ke Google Sheet!', 'success');
                this.reset();
            }
            
            submitBtn.disabled = false;
            submitBtn.innerHTML = '<i class="fas fa-paper-plane mr-2"></i>Kirim Pendaftaran';
        });

        // Export functions
        function generateTableHTML(title, year) {
            let html = `
                <div style="font-family: Arial, sans-serif; padding: 20px;">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h1 style="margin: 0; font-size: 24px; color: #1e40af;">${title}</h1>
                        <p style="margin: 5px 0; font-size: 16px; color: #4b5563;">Tahun Ajaran ${year}</p>
                        <p style="margin: 5px 0; font-size: 14px; color: #6b7280;">Dicetak pada: ${new Date().toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' })}</p>
                    </div>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                        <thead>
                            <tr style="background: #3b82f6; color: white;">
                                <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">No</th>
                                <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">Nama Lengkap</th>
                                <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">L/P</th>
                                <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">Tempat, Tgl Lahir</th>
                                <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">Nama Orang Tua</th>
                                <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">Alamat</th>
                                <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">Status</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            studentsData.forEach((student, index) => {
                const jenisKelamin = student['l/p'] || student.l_p || student['L/P'] || '-';
                const tempatTglLahir = student['tempat,tgl_lahir'] || student.tempat_tgl_lahir || '-';
                const status = student.status || 'Menunggu';
                
                html += `
                    <tr style="background: ${index % 2 === 0 ? '#f9fafb' : 'white'};">
                        <td style="border: 1px solid #ddd; padding: 10px;">${index + 1}</td>
                        <td style="border: 1px solid #ddd; padding: 10px;">${student.nama || '-'}</td>
                        <td style="border: 1px solid #ddd; padding: 10px;">${jenisKelamin}</td>
                        <td style="border: 1px solid #ddd; padding: 10px;">${tempatTglLahir}</td>
                        <td style="border: 1px solid #ddd; padding: 10px;">${student.nama_orang_tua || '-'}</td>
                        <td style="border: 1px solid #ddd; padding: 10px;">${student.alamat || '-'}</td>
                        <td style="border: 1px solid #ddd; padding: 10px;">${status}</td>
                    </tr>
                `;
            });
            
            html += `
                        </tbody>
                    </table>
                    <div style="margin-top: 30px; font-size: 12px; color: #6b7280;">
                        <p>Total Murid: ${studentsData.length}</p>
                        <p>Dikembangkan oleh: Nur Iman</p>
                    </div>
                </div>
            `;
            
            return html;
        }

        document.getElementById('export-excel-btn').addEventListener('click', function() {
            const title = document.getElementById('report-title').value;
            const year = document.getElementById('report-year').value;
            
            let csv = `${title}\nTahun Ajaran ${year}\n\n`;
            csv += 'No,Nama Lengkap,L/P,Tempat Tgl Lahir,Nama Orang Tua,Alamat,Status\n';
            
            studentsData.forEach((student, index) => {
                const jenisKelamin = student['l/p'] || student.l_p || student['L/P'] || '-';
                const tempatTglLahir = student['tempat,tgl_lahir'] || student.tempat_tgl_lahir || '-';
                const status = student.status || 'Menunggu';
                
                csv += `${index + 1},"${student.nama || '-'}",${jenisKelamin},"${tempatTglLahir}","${student.nama_orang_tua || '-'}","${student.alamat || '-'}",${status}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `${title}_${year}.csv`;
            link.click();
            
            showToast('File Excel berhasil diunduh!', 'success');
        });

        document.getElementById('export-pdf-btn').addEventListener('click', function() {
            const title = document.getElementById('report-title').value;
            const year = document.getElementById('report-year').value;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write('<html><head><title>' + title + '</title></head><body>');
            printWindow.document.write(generateTableHTML(title, year));
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            
            setTimeout(() => {
                printWindow.print();
            }, 500);
            
            showToast('Jendela print PDF dibuka!', 'success');
        });

        document.getElementById('print-report-btn').addEventListener('click', function() {
            const title = document.getElementById('report-title').value;
            const year = document.getElementById('report-year').value;
            
            const printArea = document.getElementById('print-area');
            printArea.innerHTML = generateTableHTML(title, year);
            printArea.classList.remove('hidden');
            
            window.print();
            
            printArea.classList.add('hidden');
            showToast('Laporan siap dicetak!', 'success');
        });

        async function onConfigChange(config) {
            const schoolName = config.school_name || defaultConfig.school_name;
            const tagline = config.school_tagline || defaultConfig.school_tagline;
            const sheetUrl = config.google_sheet_url || defaultConfig.google_sheet_url;
            const reportTitle = config.report_title || defaultConfig.report_title;
            const reportYear = config.report_year || defaultConfig.report_year;

            document.getElementById('login-school-name').textContent = schoolName;
            document.getElementById('login-tagline').textContent = tagline;
            document.getElementById('sidebar-school-name').textContent = schoolName;
            document.getElementById('current-sheet-url').textContent = sheetUrl;
            document.getElementById('report-title').value = reportTitle;
            document.getElementById('report-year').value = reportYear;
            document.getElementById('current-year').textContent = reportYear;
            
            if (isLoggedIn) {
                await fetchStudentData();
            }
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["admin_username", config.admin_username || defaultConfig.admin_username],
                ["admin_password", config.admin_password || defaultConfig.admin_password],
                ["school_name", config.school_name || defaultConfig.school_name],
                ["school_tagline", config.school_tagline || defaultConfig.school_tagline],
                ["google_sheet_url", config.google_sheet_url || defaultConfig.google_sheet_url],
                ["report_title", config.report_title || defaultConfig.report_title],
                ["report_year", config.report_year || defaultConfig.report_year]
            ]);
        }

        // Mobile menu functionality
        const sidebar = document.querySelector('.sidebar');
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileOverlay = document.getElementById('mobile-overlay');

        mobileMenuBtn.addEventListener('click', function() {
            sidebar.classList.add('mobile-open');
            mobileOverlay.style.display = 'block';
            setTimeout(() => {
                mobileOverlay.classList.remove('hidden');
            }, 10);
        });

        mobileOverlay.addEventListener('click', function() {
            sidebar.classList.remove('mobile-open');
            mobileOverlay.classList.add('hidden');
            setTimeout(() => {
                mobileOverlay.style.display = 'none';
            }, 300);
        });

        // Close mobile menu when clicking menu item
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function() {
                if (window.innerWidth <= 768) {
                    sidebar.classList.remove('mobile-open');
                    mobileOverlay.classList.add('hidden');
                    setTimeout(() => {
                        mobileOverlay.style.display = 'none';
                    }, 300);
                }
            });
        });

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig: defaultConfig,
                onConfigChange: onConfigChange,
                mapToCapabilities: mapToCapabilities,
                mapToEditPanelValues: mapToEditPanelValues
            });
        }
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9aab706f71dfb5cc',t:'MTc2NTE4ODI3Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>